webpackJsonp([10],{"1XFD":function(t,e,o){e=t.exports=o("BkJT")(!0),e.push([t.i,"","",{version:3,sources:[],names:[],mappings:"",file:"CourseVote.vue",sourceRoot:""}])},"3cXf":function(t,e,o){t.exports={default:o("I4CF"),__esModule:!0}},ByrR:function(t,e,o){var n=o("1XFD");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);o("8bSs")("60675902",n,!0)},I4CF:function(t,e,o){var n=o("0nnt"),s=n.JSON||(n.JSON={stringify:JSON.stringify});t.exports=function(t){return s.stringify.apply(s,arguments)}},N5Em:function(t,e,o){"use strict";function n(t){o("ByrR")}Object.defineProperty(e,"__esModule",{value:!0});var s=o("eFuq"),a=o("ebom"),i=o("/Xao"),r=n,l=i(s.a,a.a,!1,r,"data-v-1106fb55",null);e.default=l.exports},eFuq:function(t,e,o){"use strict";var n=o("3cXf"),s=o.n(n);e.a={name:"CustomModel",props:{nodeId:{type:Number,default:0}},data:function(){return{state:0,voteTem:"",voteContentsForm:{voteTitle:"",voteContents:[],nodeId:this.nodeId,id:0}}},watch:{nodeId:function(){$("#voteTable").bootstrapTable("refresh")}},methods:{addVote:function(){var t=this,e=new Array,o=!0;if(0===this.voteContentsForm.voteContents.length)bus.$emit("dialog",{type:"error",body:"无表决选项",auto:!1,time:5e3});else{for(var n=0;n<this.voteContentsForm.voteContents.length;n++){if(null===this.voteContentsForm.voteContents[n].value||""===this.voteContentsForm.voteContents[n].value)return bus.$emit("dialog",{type:"error",body:"表决选项不能为空",auto:!1,time:5e3}),o=!1,!1;e.push({id:String.fromCharCode(n+65),value:this.voteContentsForm.voteContents[n].value})}if(!o)return!1;null!=this.voteContentsForm.voteTitle&&""!=this.voteContentsForm.voteTitle?axios.post("/api/addCourseVote",{title:this.voteContentsForm.voteTitle,nodeId:this.nodeId,content:s()(e)}).then(function(e){1===e.data.status?(bus.$emit("dialog",{type:"success",body:e.data.message,auto:!0,time:5e3}),t.resetVote(),$("#voteTable").bootstrapTable("refresh")):bus.$emit("dialog",{type:"error",body:e.data.value,auto:!1,time:5e3})}).catch(function(t){bus.$emit("dialog",{type:"warn",body:"网络错误",auto:!1,time:5e3})}):bus.$emit("dialog",{type:"error",body:"表决题目不能为空",auto:!1,time:5e3})}},deleteVoteAfter:function(){var t=this;axios({method:"post",url:"/api/deleteVote",data:{id:this.id,nodeId:this.nodeId}}).then(function(e){t.resetVote(),$("#voteTable").bootstrapTable("refresh")}).catch(function(t){bus.$emit("dialog",{type:"warn",body:"网络错误",auto:!1,time:5e3})})},addDomain:function(){this.voteContentsForm.voteContents.push({id:"",value:""})},deleteDomain:function(t){var e=this.voteContentsForm.voteContents.indexOf(t);-1!==e&&this.voteContentsForm.voteContents.splice(e,1)},updateVote:function(){for(var t=this,e=new Array,o=0;o<this.voteContentsForm.voteContents.length;o++)null!==this.voteContentsForm.voteContents[o].value&&""!==this.voteContentsForm.voteContents[o].value?e.push({id:String.fromCharCode(o+65),value:this.voteContentsForm.voteContents[o].value}):bus.$emit("dialog",{type:"error",body:"表决选项不能为空",auto:!1,time:5e3});axios({method:"post",url:"/api/updateVote",data:{id:this.id,title:this.voteContentsForm.voteTitle,nodeId:this.nodeId,content:s()(e),description:this.markupStr,coverImgUrl:this.coverImgUrl}}).then(function(e){1===e.data.status?(bus.$emit("dialog",{type:"success",body:e.data.message,auto:!0,time:5e3}),t.resetVote(),$("#voteTable").bootstrapTable("refresh")):bus.$emit("dialog",{type:"error",body:e.data.value,auto:!1,time:5e3})}).catch(function(t){bus.$emit("dialog",{type:"warn",body:"网络错误",auto:!1,time:5e3})})},detailsVote:function(){var t=this;this.voteTem.forEach(function(e,o){e.id==t.id&&(t.voteContentsForm.voteTitle=e.title,t.voteContentsForm.voteContents=JSON.parse(e.content))})},resetVote:function(){this.voteContentsForm.voteTitle="",this.voteContentsForm.voteContents.splice(0,this.voteContentsForm.voteContents.length),this.state=0}},beforeCreate:function(){},created:function(){},beforeMount:function(){},mounted:function(){function t(t,e,o){return['<button class="RoleOfinfo btn btn-info" style="margin:0 10px 0 0"  OnClick=detailsVoteId("'+e.id+'")>查看</button>','<button class="RoleOfdelete btn btn-danger" style="margin:0 10px 0 0" OnClick=deleteVoteModel("'+e.id+'")>删除</button>']}var e=this;$("#voteTable").bootstrapTable({url:"/api/getCourseVote",ajaxOptions:{headers:{token:window.sessionStorage.getItem("token")}},cache:!1,toolbar:"#toolbar",singleSelect:!0,sortName:"id",searchAlign:"left",sortOrder:"asc",striped:!0,search:!1,searchOnEnterKey:!0,showRefresh:!0,method:"post",sidePagination:"server",pagination:!0,pageNumber:"1",pageSize:"10",pageList:"[10, 25, 50, 100, All]",showToggle:!0,clickToSelect:!0,columns:[{field:"state",checkbox:!0},{field:"courseNode.title",title:"章节名称"},{field:"title",title:"表决题目"},{field:"operate",title:"操作",formatter:t}],queryParams:function(t){return t.nodeId=e.nodeId,t},responseHandler:function(t){return e.voteTem=t.result.rows,t.result}}),window.deleteVoteModel=function(t){confirm("确认删除？")&&(e.id=t,e.deleteVoteAfter())},window.detailsVoteId=function(t){e.id=t,e.state=1,e.detailsVote()}},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){}}},ebom:function(t,e,o){"use strict";var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"panel-body",staticStyle:{"padding-bottom":"0px"}},[o("div",{staticClass:"panel panel-default"},[o("div",{staticClass:"panel-heading"},[t._v("表决")]),t._v(" "),o("div",{staticClass:"panel-body"},[o("form",{staticClass:"form-horizontal",attrs:{id:"formSearch"}},[o("label",[t._v("表决题目")]),t._v(" "),o("textarea",{directives:[{name:"model",rawName:"v-model",value:t.voteContentsForm.voteTitle,expression:"voteContentsForm.voteTitle"}],staticClass:"form-control",attrs:{id:"txt_search_departmentname",rows:"5"},domProps:{value:t.voteContentsForm.voteTitle},on:{input:function(e){e.target.composing||t.$set(t.voteContentsForm,"voteTitle",e.target.value)}}})])]),t._v(" "),o("div",{staticClass:"panel-body"},[o("label",[t._v("表决选项")]),t._v(" "),t._l(t.voteContentsForm.voteContents,function(e,n){return o("tr",[o("form",{staticClass:"form-inline"},[o("div",{staticClass:"form-group"},[o("label",{staticClass:"col-md-1"},[o("p",{staticClass:"form-control-static"},[t._v(t._s(String.fromCharCode(n+65)))])])]),t._v(" "),o("div",{staticClass:"form-group"},[o("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"voteContent.value"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:e.value},on:{input:function(o){o.target.composing||t.$set(e,"value",o.target.value)}}})]),t._v(" "),o("button",{staticClass:"btn btn-default",attrs:{type:"button"},on:{click:function(o){t.deleteDomain(e)}}},[o("span",{staticClass:"glyphicon glyphicon-remove",attrs:{"aria-hidden":"true"}}),t._v("删除\n            ")])])])})],2)]),t._v(" "),o("div",{staticClass:"panel-footer"},[0===t.state?o("button",{staticClass:"btn btn-default",attrs:{id:"btn_add",type:"button"},on:{click:function(e){t.addVote()}}},[o("span",{staticClass:"glyphicon glyphicon-plus",attrs:{"aria-hidden":"true"}}),t._v("提交\n      ")]):t._e(),t._v(" "),1===t.state?o("button",{staticClass:"btn btn-default",attrs:{id:"btn_update",type:"button"},on:{click:function(e){t.updateVote()}}},[o("span",{staticClass:"glyphicon glyphicon-arrow-up",attrs:{"aria-hidden":"true"}}),t._v("修改\n      ")]):t._e(),t._v(" "),o("button",{staticClass:"btn btn-default",attrs:{id:"btn_edit",type:"button"},on:{click:function(e){t.addDomain()}}},[o("span",{staticClass:"glyphicon glyphicon-pencil",attrs:{"aria-hidden":"true"}}),t._v("新增选项\n      ")]),t._v(" "),o("button",{staticClass:"btn btn-default",attrs:{id:"btn_reset",type:"button"},on:{click:function(e){t.resetVote()}}},[o("span",{staticClass:"glyphicon glyphicon glyphicon-repeat",attrs:{"aria-hidden":"true"}}),t._v("重置\n      ")])]),t._v(" "),o("div",{staticClass:"btn-group",attrs:{id:"toolbar"}}),t._v(" "),t._m(0,!1,!1)])},s=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("table",{attrs:{id:"voteTable"}})])}],a={render:n,staticRenderFns:s};e.a=a}});
//# sourceMappingURL=10.57d0a359d50cde6435ba.js.map